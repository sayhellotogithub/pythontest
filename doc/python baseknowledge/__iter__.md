## **`__iter__` ã«ã¤ã„ã¦**

`__iter__` ã¯ã€Python ã® **ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ (iterator)** ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã®ç‰¹æ®Šãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ï¼‰ã§ã™ã€‚

ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹ã‚’ **ã‚¤ãƒ†ãƒ©ãƒ–ãƒ« (iterable)** ã«ã™ã‚‹ã«ã¯ã€`__iter__` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

------

## **1. `__iter__` ã®åŸºæœ¬**

`__iter__` ã¯ **ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åå¾©å¯èƒ½ (iterable) ã«ã™ã‚‹** ãŸã‚ã«ä½¿ã‚ã‚Œã¾ã™ã€‚`for` ãƒ«ãƒ¼ãƒ—ã‚„ `list()` ãªã©ã®é–¢æ•°ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚

### **ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã¨ã¯ï¼Ÿ**

**ã‚¤ãƒ†ãƒ©ãƒ–ãƒ« (iterable)** ã¨ã¯ã€`for` ãƒ«ãƒ¼ãƒ—ã§åå¾©ã§ãã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã“ã¨ã§ã™ã€‚
Python ã®çµ„ã¿è¾¼ã¿ãƒ‡ãƒ¼ã‚¿å‹ï¼ˆ`list`, `tuple`, `dict`, `set`, `str` ãªã©ï¼‰ã¯ã™ã¹ã¦ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã§ã™ã€‚

------

## **2. `__iter__` ã®å®Ÿè£…**

ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã«ã™ã‚‹ã«ã¯ã€`__iter__` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã€**ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ (iterator)** ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### **â‘  `__iter__` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…**

```
class MyNumbers:
    def __init__(self, start, end):
        self.start = start
        self.end = end

    def __iter__(self):
        """ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™"""
        self.current = self.start  # ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ä½ç½®
        return self

    def __next__(self):
        """æ¬¡ã®è¦ç´ ã‚’è¿”ã™"""
        if self.current > self.end:
            raise StopIteration  # ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†
        value = self.current
        self.current += 1
        return value

# ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
numbers = MyNumbers(1, 5)

# for ãƒ«ãƒ¼ãƒ—ã§åå¾©å‡¦ç†
for num in numbers:
    print(num)

# å‡ºåŠ›:
# 1
# 2
# 3
# 4
# 5
```

### **ãƒã‚¤ãƒ³ãƒˆ**

âœ… `__iter__` ãƒ¡ã‚½ãƒƒãƒ‰ â†’ `self` ã‚’è¿”ã™
âœ… `__next__` ãƒ¡ã‚½ãƒƒãƒ‰ â†’ åå¾©å‡¦ç†ã® **æ¬¡ã®å€¤ã‚’è¿”ã™**
âœ… `StopIteration` ã‚’ `raise` ã™ã‚‹ã¨ãƒ«ãƒ¼ãƒ—çµ‚äº†

ã“ã®ã‚ˆã†ã«ã€`__iter__` ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ `for` ãƒ«ãƒ¼ãƒ—ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

------

## **3. `__iter__` ã‚’ `iter()` ã§ç¢ºèª**

`iter()` ã‚’ä½¿ã†ã¨ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã§ã‚ã‚‹ã‹ã‚’ç¢ºèªã§ãã¾ã™ã€‚

```
numbers = MyNumbers(1, 3)

# ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—
iterator = iter(numbers)

# `next()` ã§è¦ç´ ã‚’å–å¾—
print(next(iterator))  # å‡ºåŠ›: 1
print(next(iterator))  # å‡ºåŠ›: 2
print(next(iterator))  # å‡ºåŠ›: 3
print(next(iterator))  # StopIteration ç™ºç”Ÿ
```

------

## **4. `__iter__` ãªã—ã®ã‚¯ãƒ©ã‚¹**

ã‚‚ã— `__iter__` ã‚’å®Ÿè£…ã—ãªã„ã¨ã€æ¬¡ã®ã‚ˆã†ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚

```
class NoIterable:
    def __init__(self, value):
        self.value = value

obj = NoIterable(10)

# for ãƒ«ãƒ¼ãƒ—ã‚’è©¦ã™
for x in obj:
    print(x)  # TypeError: 'NoIterable' object is not iterable
```

âœ… `__iter__` ã‚’å®Ÿè£…ã—ãªã„ã¨ã€ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã¨ã—ã¦æ‰±ãˆãªã„ã€‚

------

## **5. `__iter__` ã‚’ãƒªã‚¹ãƒˆã®ã‚ˆã†ã«ä½¿ã†**

ãƒªã‚¹ãƒˆã®ã‚ˆã†ã«ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹ã‚’æ‰±ã†ã«ã¯ã€`__iter__` ã§ `iter()` ã‚’å‘¼ã³å‡ºã›ã°OKã€‚

```
class MyList:
    def __init__(self, items):
        self.items = items

    def __iter__(self):
        """ãƒªã‚¹ãƒˆã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’è¿”ã™"""
        return iter(self.items)  # ãƒªã‚¹ãƒˆã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’è¿”ã™

my_list = MyList([10, 20, 30, 40])

# for ãƒ«ãƒ¼ãƒ—ã§ä½¿ã†
for item in my_list:
    print(item)

# å‡ºåŠ›:
# 10
# 20
# 30
# 40
```

âœ… **ãƒªã‚¹ãƒˆã® `iter()` ã‚’ãã®ã¾ã¾è¿”ã™** ã“ã¨ã§ã€ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã«ã™ã‚‹ã€‚
âœ… **`__next__` ã‚’å®Ÿè£…ã—ãªãã¦ã‚‚OK**ï¼ˆPython ã®ãƒªã‚¹ãƒˆãŒ `__next__` ã‚’æŒã¤ãŸã‚ï¼‰ã€‚

------

## **6. `yield` ã‚’ä½¿ã£ãŸ `__iter__`**

ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ã†ã¨ã€ã‚‚ã£ã¨ç°¡å˜ã« `__iter__` ã‚’å®Ÿè£…ã§ãã¾ã™ã€‚

```
class MyNumbers:
    def __init__(self, start, end):
        self.start = start
        self.end = end

    def __iter__(self):
        """ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã§ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ä½œæˆ"""
        current = self.start
        while current <= self.end:
            yield current
            current += 1

# ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
numbers = MyNumbers(1, 5)

# for ãƒ«ãƒ¼ãƒ—ã§ä½¿ã†
for num in numbers:
    print(num)

# å‡ºåŠ›:
# 1
# 2
# 3
# 4
# 5
```

âœ… `yield` ã‚’ä½¿ã†ã¨ã€**`__next__` ã‚’è‡ªå‹•çš„ã«å®Ÿè£…** ã§ãã‚‹ã€‚
âœ… ã‚³ãƒ¼ãƒ‰ãŒã‚·ãƒ³ãƒ—ãƒ«ã§ã€ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãŒè‰¯ã„ï¼ˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã®åˆ©ç‚¹ï¼‰ã€‚

------

## **7. ã¾ã¨ã‚**

âœ… **`__iter__` ã‚’å®Ÿè£…ã™ã‚‹ã¨ `for` ãƒ«ãƒ¼ãƒ—ã§åå¾©å¯èƒ½ã«**
âœ… **ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã¯ `__iter__` (selfã‚’è¿”ã™) ã¨ `__next__` (å€¤ã‚’è¿”ã™) ã‚’å®Ÿè£…ã™ã‚‹**
âœ… **ãƒªã‚¹ãƒˆã® `iter()` ã‚’è¿”ã™ã“ã¨ã§ç°¡å˜ã«ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã«ã§ãã‚‹**
âœ… **ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ (`yield`) ã‚’ä½¿ã†ã¨ `__next__` ã‚’çœç•¥ã§ãã‚‹**

ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹ã‚’ **ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã¨ã—ã¦å‹•ä½œã•ã›ã‚‹** ã“ã¨ã§ã€ã‚ˆã‚ŠæŸ”è»Ÿãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ä½œæˆã§ãã¾ã™ï¼ ğŸš€